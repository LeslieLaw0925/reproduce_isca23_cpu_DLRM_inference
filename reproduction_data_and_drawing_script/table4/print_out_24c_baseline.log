Using CPU...
start to create emb, minimally need ~28.6102294921875 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.25506591796875 G
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
create emb done, current mem usage: 28.930438995361328 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 28.930442810058594 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
Average latency per example: 113.924ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 210.67
Total time: 569.620ms
Throughput: 13482.674 fps
 
Using CPU...
start to create emb, minimally need ~57.220458984375 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.3020515441894531 G
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
create emb done, current mem usage: 57.65071105957031 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 57.65071487426758 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
Average latency per example: 264.754ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 90.65
Total time: 1.324s
Throughput: 5801.619 fps
 
Using CPU...
start to create emb, minimally need ~81.06231689453125 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.3948402404785156 G
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
create emb done, current mem usage: 81.63655853271484 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 81.63656616210938 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,1000000
Average latency per example: 384.060ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 62.49
Total time: 1.920s
Throughput: 3999.373 fps
 
Using CPU...
start to create emb, minimally need ~28.6102294921875 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.2563591003417969 G
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
create emb done, current mem usage: 28.93185806274414 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 28.931861877441406 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
Average latency per example: 60.420ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 397.22
Total time: 302.099ms
Throughput: 25422.151 fps
 
Using CPU...
start to create emb, minimally need ~57.220458984375 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.302703857421875 G
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
create emb done, current mem usage: 57.6513786315918 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 57.651390075683594 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
Average latency per example: 148.985ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 161.09
Total time: 744.925ms
Throughput: 10309.768 fps
 
Using CPU...
start to create emb, minimally need ~81.06231689453125 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.3948478698730469 G
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
create emb done, current mem usage: 81.63655471801758 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 81.63656616210938 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,1000000
Average latency per example: 266.705ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 89.99
Total time: 1.334s
Throughput: 5759.167 fps
 
Using CPU...
start to create emb, minimally need ~28.6102294921875 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.2572174072265625 G
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
create emb done, current mem usage: 28.930767059326172 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 28.930770874023438 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
Average latency per example: 48.275ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 497.15
Total time: 241.377ms
Throughput: 31817.496 fps
 
Using CPU...
start to create emb, minimally need ~57.220458984375 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.3017234802246094 G
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
create emb done, current mem usage: 57.65909194946289 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 57.659095764160156 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
Average latency per example: 105.921ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 226.58
Total time: 529.603ms
Throughput: 14501.430 fps
 
Using CPU...
start to create emb, minimally need ~81.06231689453125 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.39493560791015625 G
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
Create Embedding: 1000000
create emb done, current mem usage: 81.63671112060547 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 81.63671875 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,1000000
Average latency per example: 146.990ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 163.28
Total time: 734.951ms
Throughput: 10449.672 fps

Using CPU...
start to create emb, minimally need ~3.814697265625 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.3150291442871094 G
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
create emb done, current mem usage: 4.134326934814453 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 4.134326934814453 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_low/table_1M.txt,500000
Average latency per example: 25.247ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 950.62
Total time: 126.234ms
Throughput: 60839.579 fps

Using CPU...
start to create emb, minimally need ~3.814697265625 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.3133354187011719 G
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
create emb done, current mem usage: 4.130565643310547 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 4.130565643310547 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_medium/table_1M.txt,500000
Average latency per example: 19.643ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 1221.80
Total time: 98.216ms
Throughput: 78195.075 fps

Using CPU...
start to create emb, minimally need ~3.814697265625 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.31453704833984375 G
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
create emb done, current mem usage: 4.1337890625 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 4.13397216796875 G
Testing for inference only
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
dataset prod,/root/nfs/isca23_dlrm/reproduce_isca23_cpu_DLRM_inference/datasets/reuse_high/table_1M.txt,500000
Average latency per example: 10.180ms
Total number of iterations: 120
Total number of iterations per second (across all threads): 2357.59
Total time: 50.899ms
Throughput: 150885.905 fps
